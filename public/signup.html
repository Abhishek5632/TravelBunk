<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign Up - TravelBunk</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,#00BFA6,#FDCB6E);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  overflow-x:hidden;
}

/* Navbar */
.navbar{
  position:absolute;top:0;width:100%;
  background:rgba(255,255,255,0.25);
  backdrop-filter:blur(10px);
  box-shadow:0 2px 10px rgba(0,0,0,0.1);
  padding:15px 0;z-index:100;
}
.nav-container{
  max-width:1100px;margin:auto;display:flex;
  justify-content:space-between;align-items:center;
  padding:0 20px;
}
.nav-logo h2{
  color:white;font-size:1.8rem;font-weight:700;
}
.nav-menu{list-style:none;display:flex;gap:1.8rem;}
.nav-menu a{
  text-decoration:none;color:white;font-weight:500;transition:0.3s;
}
.nav-menu a:hover{color:#222;}

/* Auth Card */
.auth-container{
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(12px);
  padding:40px 35px;
  border-radius:25px;
  box-shadow:0 10px 35px rgba(0,0,0,0.1);
  width:90%;
  max-width:500px;
  text-align:center;
  margin-top:100px;
  animation:fadeIn 0.8s ease-in-out;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

.auth-container h1{color:#00BFA6;font-size:2rem;margin-bottom:8px;}
.auth-container p{color:#555;font-weight:500;margin-bottom:20px;}

.form-group{text-align:left;margin-bottom:15px;}
label{display:block;margin-bottom:5px;font-weight:500;color:#333;}
input,select{
  width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:10px;
  font-size:1rem;outline:none;transition:0.3s;
}
input:focus,select:focus{border-color:#00BFA6;box-shadow:0 0 6px #00bfa64d;}
small{color:#777;font-size:0.85rem;}

.form-row{display:flex;gap:15px;}
.form-row .form-group{flex:1;}

.btn-full{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:linear-gradient(135deg,#00BFA6,#FDCB6E);
  color:white;
  font-weight:600;
  font-size:1.05rem;
  cursor:pointer;
  transition:0.3s ease;
  margin-top:10px;
}
.btn-full:hover{transform:scale(1.03);box-shadow:0 4px 15px rgba(0,191,166,0.3);}

/* Photo Preview */
#photoPreview{
  width:100px;height:100px;border-radius:50%;overflow:hidden;
  border:2px solid #00BFA6;margin-bottom:10px;background:#eee;
}
#previewImg{width:100%;height:100%;object-fit:cover;}

/* Checkbox group */
.checkbox-group{display:flex;align-items:center;margin-top:10px;}
.checkbox-label{position:relative;padding-left:30px;cursor:pointer;font-size:15px;color:#333;}
.checkbox-label input{position:absolute;opacity:0;cursor:pointer;}
.checkmark{
  position:absolute;left:0;top:2px;height:20px;width:20px;
  background-color:#e0e0e0;border-radius:6px;transition:0.3s;
}
.checkbox-label input:checked~.checkmark{background-color:#00BFA6;}
.checkmark:after{
  content:"";position:absolute;display:none;left:6px;top:3px;
  width:6px;height:12px;border:solid white;border-width:0 3px 3px 0;
  transform:rotate(45deg);
}
.checkbox-label input:checked~.checkmark:after{display:block;}
.checkbox-label a{color:#00BFA6;text-decoration:none;margin:0 4px;}
.checkbox-label a:hover{text-decoration:underline;}

.auth-switch{margin-top:15px;}
.auth-switch a{color:#00BFA6;font-weight:600;text-decoration:none;}
.auth-switch a:hover{text-decoration:underline;}

@media(max-width:500px){
  .auth-container{padding:30px 25px;}
  .form-row{flex-direction:column;}
}
</style>
</head>

<body>
<nav class="navbar">
  <div class="nav-container">
    <div class="nav-logo"><h2>TravelBuddy</h2></div>
    <ul class="nav-menu">
      <li><a href="index.html">Home</a></li>
      <li><a href="signin.html">Login</a></li>
      <li><a href="signup.html" class="active">Sign Up</a></li>
    </ul>
  </div>
</nav>

<div class="auth-container">
  <h1>Join the Travel Tribe üåç</h1>
  <p>Create your TravelBunk account to meet new companions!</p>

  <form id="signupForm" enctype="multipart/form-data">
    <div class="form-row">
      <div class="form-group">
        <label for="firstName">First Name</label>
        <input type="text" id="firstName" name="firstName" required>
      </div>
      <div class="form-group">
        <label for="lastName">Last Name</label>
        <input type="text" id="lastName" name="lastName" required>
      </div>
    </div>

    <div class="form-group" style="text-align:center;">
      <label for="profilePhoto"><b>Profile Photo</b></label>
      <div style="display:flex;flex-direction:column;align-items:center;margin-top:8px;">
        <div id="photoPreview">
          <img id="previewImg" src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png" alt="Preview">
        </div>
        <input type="file" id="profilePhoto" name="profilePhoto" accept="image/*" required style="border:1px solid #ccc;border-radius:10px;padding:6px 10px;width:85%;cursor:pointer;">
      </div>
    </div>

    <div class="form-group">
      <label for="email">Email Address</label>
      <input type="email" id="email" name="email" required>
    </div>

    <div class="form-group">
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone" required>
    </div>

    <div class="form-group">
      <label for="college">College (Optional)</label>
      <input type="text" id="college" name="college">
    </div>

    <div class="form-group">
      <label for="age">Age</label>
      <select id="age" name="age" required>
        <option value="">Select your age range</option>
        <option value="18-22">18-22</option>
        <option value="23-27">23-27</option>
        <option value="28-32">28-32</option>
        <option value="33+">33+</option>
      </select>
    </div>

    <div class="form-group">
      <label for="travelStyle">Travel Style</label>
      <select id="travelStyle" name="travelStyle" required>
        <option value="">What's your vibe?</option>
        <option value="budget">Budget Explorer üí∞</option>
        <option value="adventure">Adventure Seeker üèîÔ∏è</option>
        <option value="cultural">Culture Enthusiast üèõÔ∏è</option>
        <option value="relaxed">Chill Traveler üèñÔ∏è</option>
        <option value="party">Party Hopper üéâ</option>
        <option value="solo">Solo to Group üë•</option>
      </select>
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" id="password" name="password" required>
      <small>At least 8 characters with numbers and letters</small>
    </div>

    <div class="form-group">
      <label for="confirmPassword">Confirm Password</label>
      <input type="password" id="confirmPassword" name="confirmPassword" required>
    </div>

    <div class="form-group">
      <label for="aadhaar">Aadhaar Number</label>
      <input type="text" id="aadhaar" name="aadhaar" required maxlength="12" pattern="\d{12}" placeholder="Enter 12-digit Aadhaar">
    </div>

    <div class="form-group checkbox-group">
      <label class="checkbox-label">
        <input type="checkbox" id="terms" required>
        <span class="checkmark"></span>
        I agree to the <a href="#">Terms</a> & <a href="#">Privacy Policy</a>
      </label>
    </div>

    <div class="form-group checkbox-group">
      <label class="checkbox-label">
        <input type="checkbox" id="newsletter">
        <span class="checkmark"></span>
        Send me travel tips & companion updates
      </label>
    </div>

    <button type="submit" class="btn-full">Create Account üöÄ</button>
    <p class="auth-switch">Already a member? <a href="signin.html">Sign In</a></p>
  </form>
</div>

<script>
const baseURL = window.location.hostname === "localhost"
  ? "http://localhost:5001"
  : "https://travelbuddy-hluu.onrender.com";

// ‚úÖ Image preview
document.getElementById("profilePhoto").addEventListener("change", e => {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = ev => document.getElementById("previewImg").src = ev.target.result;
    reader.readAsDataURL(file);
  }
});

// ‚úÖ Signup
document.getElementById("signupForm").addEventListener("submit", async e => {
  e.preventDefault();
  const form = e.target;
  const data = {
    firstName: form.firstName.value.trim(),
    lastName: form.lastName.value.trim(),
    email: form.email.value.trim(),
    phone: form.phone.value.trim(),
    college: form.college.value.trim(),
    age: form.age.value,
    travelStyle: form.travelStyle.value,
    aadhaar: form.aadhaar.value.trim(),
    password: form.password.value.trim(),
    newsletter: form.newsletter.checked,
  };
  const file = form.profilePhoto.files[0];
  if (file) data.img = await fileToBase64(file);

  if (data.password !== form.confirmPassword.value.trim()) {
    alert("Passwords do not match!");
    return;
  }

  try {
    const res = await fetch(`${baseURL}/api/signup`, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(data),
    });
    const result = await res.json();
    if (result.success) {
      localStorage.setItem("user", JSON.stringify(result.user));
      alert("üéâ Account created successfully!");
      window.location.href = "profile.html";
    } else {
      alert(result.message || "Signup failed.");
    }
  } catch (err) {
    console.error("Signup error:", err);
    alert("Server connection failed.");
  }
});

function fileToBase64(file){
  return new Promise((resolve,reject)=>{
    const reader=new FileReader();
    reader.onload=()=>resolve(reader.result);
    reader.onerror=err=>reject(err);
    reader.readAsDataURL(file);
  });
}
</script>
</body>
</html>
