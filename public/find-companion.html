<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find Companion | TravelMate</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Poppins',sans-serif;background:#f9f9f9;line-height:1.6;}
.navbar{background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);position:fixed;top:0;width:100%;z-index:1000;box-shadow:0 2px 20px rgba(0,191,166,0.1);}
.nav-container{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center;height:70px;}
.nav-logo h2{color:#00BFA6;font-size:1.8rem;font-weight:700;}
.nav-menu{display:flex;list-style:none;gap:2rem;}
.nav-menu li a{text-decoration:none;color:#2D3436;font-weight:500;font-size:1rem;position:relative;}
.nav-menu li a:hover{color:#00BFA6;}
.nav-menu li a::after{content:'';position:absolute;width:0;height:2px;background:#00BFA6;bottom:-5px;left:0;transition:0.3s;}
.nav-menu li a:hover::after{width:100%;}
.hamburger{display:none;flex-direction:column;cursor:pointer;}
.hamburger span{width:25px;height:3px;background:#2D3436;margin:3px 0;border-radius:2px;}
@media(max-width:768px){.nav-menu{position:fixed;top:70px;left:-100%;flex-direction:column;background:white;width:100%;padding:2rem 0;transition:0.3s;box-shadow:0 10px 27px rgba(0,0,0,0.05);}.nav-menu.active{left:0;}.hamburger{display:flex;}}
.page-header{padding:120px 20px 20px;text-align:center;background:#00BFA6;color:white;}
.page-header h1{font-size:2.5rem;margin-bottom:10px;}
.tabs{text-align:center;margin:20px 0;}
.tab-btn{padding:10px 25px;margin:0 10px;border:none;border-radius:20px;background:#eee;cursor:pointer;font-size:1rem;transition:0.3s;}
.tab-btn.active{background:#00BFA6;color:white;}
.filter-card{max-width:1100px;margin:20px auto;padding:20px;background:white;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1);display:flex;gap:10px;flex-wrap:wrap;}
.filter-card input, .filter-card button{padding:10px;border-radius:6px;border:1px solid #ccc;}
.filter-card button{background:#00BFA6;color:white;border:none;cursor:pointer;transition:0.3s;}
.filter-card button:hover{background:#01967f;}
.cards-container{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;padding:20px;}
.profile-card{background:white;border-radius:15px;padding:20px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.1);transition:0.3s;}
.profile-card:hover{transform:translateY(-5px);}
.profile-pic{width:120px;height:120px;border-radius:50%;object-fit:cover;margin-bottom:15px;}
.stats{display:flex;justify-content:space-around;margin-top:15px;}
.stat-box{background:#f1f3f6;padding:10px;border-radius:10px;flex:1;margin:0 5px;}
.connect-btn{margin-top:10px;padding:10px 20px;border:none;border-radius:6px;background:#00BFA6;color:white;cursor:pointer;transition:0.3s;}
.connect-btn:hover{background:#01967f;}
.footer{background:#2D3436;color:white;text-align:center;padding:3rem 20px;margin-top:40px;}
.footer p{color:#ccc;margin-top:1rem;}
</style>
</head>
<body>

<nav class="navbar">
<div class="nav-container">
<div class="nav-logo"><h2>TravelMate</h2></div>
<ul class="nav-menu">
<li><a href="index.html">Home</a></li>
<li><a href="find-companion.html">Find Companion</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
<div class="hamburger"><span></span><span></span><span></span></div>
</div>
</nav>

<section class="page-header">
<h1>Find a Travel Companion</h1>
<p>Filter by destination and dates</p>
</section>

<div class="tabs">
<button class="tab-btn active" data-tab="college">College Students</button>
<button class="tab-btn" data-tab="normal">Normal Travelers</button>
</div>

<div class="filter-card">
<input type="text" id="destination" placeholder="Destination">
<input type="date" id="startDate">
<input type="date" id="endDate">
<button id="searchBtn">Search</button>
</div>

<div id="college" class="cards-container"></div>
<div id="normal" class="cards-container" style="display:none;"></div>

<footer class="footer">
<h3>TravelMate</h3>
<p>&copy; 2025 TravelMate. All rights reserved.</p>
</footer>

<script>
const hamburger=document.querySelector(".hamburger");
const navMenu=document.querySelector(".nav-menu");
hamburger.addEventListener("click",()=>{ navMenu.classList.toggle("active"); });

const tabs=document.querySelectorAll(".tab-btn");
const collegeDiv=document.getElementById("college");
const normalDiv=document.getElementById("normal");
let activeTab = "college";

tabs.forEach(tab=>{
  tab.addEventListener("click",()=>{
    tabs.forEach(t=>t.classList.remove("active"));
    tab.classList.add("active");
    activeTab = tab.dataset.tab;
    if(activeTab==="college"){ collegeDiv.style.display="grid"; normalDiv.style.display="none"; }
    else { collegeDiv.style.display="none"; normalDiv.style.display="grid"; }
    filterResults();
  });
});

// Demo data
const demoCollege = [
  { name:"Rahul Sharma", college:"GL Bajaj", destination:"Goa", start:"2025-10-10", end:"2025-10-12", img:"https://randomuser.me/api/portraits/men/32.jpg", trips:5, distance:"250 km", bio:"Love beaches and adventure." },
  { name:"Priya Mehta", college:"Amity", destination:"Goa", start:"2025-10-11", end:"2025-10-13", img:"https://randomuser.me/api/portraits/women/44.jpg", trips:3, distance:"120 km", bio:"Traveller & foodie." }
];
const demoNormal = [
  { name:"Aman Verma", destination:"Manali", start:"2025-10-15", end:"2025-10-20", img:"https://randomuser.me/api/portraits/men/50.jpg", trips:7, distance:"350 km", bio:"Mountains are my vibe." },
  { name:"Sneha Kapoor", destination:"Rishikesh", start:"2025-10-18", end:"2025-10-21", img:"https://randomuser.me/api/portraits/women/65.jpg", trips:4, distance:"180 km", bio:"Adventure seeker and yogi." }
];

let collegeUsers = [];
let normalUsers = [];

// Render profiles
function renderProfiles(container, users){
  container.innerHTML="";
  if(users.length===0){
    container.innerHTML="<p class='text-muted'>No companions found.</p>";
    return;
  }
  users.forEach(u=>{
    const div=document.createElement("div");
    div.className="profile-card";
    div.innerHTML=`
      <img src="${u.img || 'https://randomuser.me/api/portraits/lego/1.jpg'}" class="profile-pic">
      <h5 class="fw-bold">${u.name}</h5>
      ${u.college ? `<p class="text-muted mb-1">${u.college}</p>` : ""}
      <p><b>${u.destination}</b> (${u.start} â†’ ${u.end})</p>
      <p class="small">${u.bio || ''}</p>
      <div class="stats">
        <div class="stat-box"><b>${u.trips || 0}</b><br>Trips</div>
        <div class="stat-box"><b>${u.distance || 'N/A'}</b><br>Distance</div>
      </div>
      <button class="connect-btn" onclick='connectUser(${JSON.stringify(u)})'>Connect</button>
    `;
    container.appendChild(div);
  });
}

// Filter results
function filterResults(){
  const dest = document.getElementById("destination").value.toLowerCase();
  const start = document.getElementById("startDate").value;
  const end = document.getElementById("endDate").value;

  const collegeFiltered = collegeUsers.filter(u => 
    u.destination.toLowerCase().includes(dest) &&
    (!start || u.start >= start) &&
    (!end || u.end <= end)
  );
  const normalFiltered = normalUsers.filter(u => 
    u.destination.toLowerCase().includes(dest) &&
    (!start || u.start >= start) &&
    (!end || u.end <= end)
  );
  renderProfiles(collegeDiv, collegeFiltered.length?collegeFiltered:demoCollege);
  renderProfiles(normalDiv, normalFiltered.length?normalFiltered:demoNormal);
}

document.getElementById("searchBtn").addEventListener("click", filterResults);

// Connect button
function connectUser(user) {
  const dataStr = encodeURIComponent(JSON.stringify(user));
  window.location.href = `profile2.html?data=${dataStr}`;
}

// Load users from backend
async function loadUsersFromBackend(){
  try{
    const res = await fetch('/api/companions'); 
    const data = await res.json();
    if(data.success && data.companions){
      collegeUsers = data.companions.filter(u=>u.college);
      normalUsers = data.companions.filter(u=>!u.college);
    }
    filterResults();
  }catch(err){
    console.error("Error loading users:", err);
    collegeUsers = demoCollege;
    normalUsers = demoNormal;
    filterResults();
  }
}

loadUsersFromBackend();
</script>
</body>
</html>
