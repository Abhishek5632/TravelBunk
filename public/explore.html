<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add Trip | TravelBuddy</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Poppins',sans-serif;line-height:1.6;background:#f9f9f9;}

    /* Navbar */
    .navbar{
      background:rgba(255,255,255,0.95);
      backdrop-filter:blur(10px);
      position:fixed;top:0;width:100%;z-index:1000;
      box-shadow:0 2px 20px rgba(0,191,166,0.1);
    }
    .nav-container{
      max-width:1200px;margin:0 auto;padding:0 20px;
      display:flex;justify-content:space-between;align-items:center;height:70px;
    }
    .nav-logo h2{color:#00BFA6;font-size:1.8rem;font-weight:700;}
    .nav-menu{display:flex;list-style:none;gap:2rem;}
    .nav-menu li a{
      text-decoration:none;color:#2D3436;font-weight:500;
      font-size:1rem;position:relative;
    }
    .nav-menu li a:hover{color:#00BFA6;}
    .hamburger{display:none;flex-direction:column;cursor:pointer;}
    .hamburger span{width:25px;height:3px;background:#2D3436;margin:3px 0;border-radius:2px;}
    @media(max-width:768px){
      .nav-menu{
        position:fixed;top:70px;left:-100%;
        flex-direction:column;background:white;
        width:100%;padding:2rem 0;transition:0.3s;
        box-shadow:0 10px 27px rgba(0,0,0,0.05);
      }
      .nav-menu.active{left:0;}
      .hamburger{display:flex;}
    }

    /* Hero Header */
    .hero{
      padding:120px 20px 50px;
      text-align:center;
      background:linear-gradient(135deg,#00BFA6,#FDCB6E);
      color:white;
    }
    .hero h1{font-size:2.5rem;margin-bottom:10px;}
    .hero p{font-size:1.1rem;}

    /* Container */
    .container{
      max-width:600px;
      margin:80px auto 50px;
      background:white;
      border-radius:15px;
      padding:30px 25px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1);
      text-align:center;
    }
    .container h2{color:#00BFA6;margin-bottom:15px;font-size:1.8rem;}
    form input, form textarea, form button{
      width:100%;padding:12px 15px;margin:10px 0;
      border-radius:8px;border:1px solid #ccc;font-size:1rem;
    }
    form textarea{resize:none;height:80px;}
    form input:focus, form textarea:focus{
      border-color:#00BFA6;outline:none;
      box-shadow:0 0 6px rgba(0,191,166,0.3);
    }
    form button{
      background:#00BFA6;color:white;border:none;
      font-weight:600;cursor:pointer;transition:0.3s;
    }
    form button:hover{background:#01967f;}
    #message{margin-top:15px;font-size:0.95rem;font-weight:500;}
    
    .footer{
      background:#2D3436;color:white;text-align:center;padding:3rem 20px;margin-top:40px;
    }
    .footer p{color:#ccc;margin-top:1rem;}
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo"><h2>TravelBuddy</h2></div>
      <ul class="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="find-companion.html">Find Companion</a></li>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="profile.html">Profile</a></li>
      </ul>
      <div class="hamburger"><span></span><span></span><span></span></div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="hero">
    <h1>üß≥ Plan Your Next Journey</h1>
    <p>Add your trip details and find perfect companions to travel with!</p>
  </section>

  <!-- Form Section -->
  <section class="container">
    <h2>Add a New Trip</h2>
    <form id="addTripForm">
      <input type="email" id="email" placeholder="Your Email" required readonly>
      <input type="text" id="college" placeholder="College (optional)">
      <input type="date" id="date" required>
      <input type="text" id="destination" placeholder="Destination" required>
      <input type="number" id="distance" placeholder="Approx Distance (in km)">
      <textarea id="description" placeholder="Describe your trip (optional)"></textarea>
      <button type="submit">Add Trip</button>
    </form>
    <p id="message"></p>
  </section>

  <footer class="footer">
    <h3>TravelBuddy</h3>
    <p>&copy; 2025 TravelBuddy. All rights reserved.</p>
  </footer>

  <script>
    const hamburger = document.querySelector(".hamburger");
    const navMenu = document.querySelector(".nav-menu");
    hamburger.addEventListener("click", () => navMenu.classList.toggle("active"));

    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      alert("Please login first to access this page.");
      window.location.href = "signin.html";
    }

    const emailField = document.getElementById("email");
    const msg = document.getElementById("message");
    if (user) emailField.value = user.email;

    document.getElementById("addTripForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!user) return;

      const trip = {
        email: user.email,
        college: document.getElementById("college").value.trim(),
        date: document.getElementById("date").value,
        destination: document.getElementById("destination").value.trim(),
        distance: document.getElementById("distance").value.trim(),
        description: document.getElementById("description").value.trim(),
      };

      if (!trip.date || !trip.destination) {
        msg.style.color = "red";
        msg.textContent = "‚ö†Ô∏è Please fill all required fields!";
        return;
      }

      try {
        const res = await fetch("/api/add-trip", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(trip),
        });
        const data = await res.json();
        if (data.success) {
          msg.style.color = "green";
          msg.textContent = "‚úÖ Trip added successfully!";
          user.trips = data.trips;
          localStorage.setItem("user", JSON.stringify(user));
          document.getElementById("addTripForm").reset();
          emailField.value = user.email;
        } else {
          msg.style.color = "red";
          msg.textContent = "‚ùå " + data.message;
        }
      } catch (err) {
        msg.style.color = "red";
        msg.textContent = "‚ö†Ô∏è Server error. Try again later!";
        console.error(err);
      }
    });
  </script>

</body>
</html>
